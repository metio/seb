<!doctype html><html lang=en><head><meta charset=utf-8><meta name=author content="Sebastian Hoß"><meta name=subject content="Sebastian Hoß"><meta name=description content="articles about software engineering"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:url" content="https://seb.xn--ho-hia.de/posts/shell-init/"><meta property="og:site_name" content="Sebastian Hoß"><meta property="og:title" content="chezmoi & shell init scripts"><meta property="og:description" content='Many CLI applications offer initialization scripts to integrate into a shell, for example starship init zsh or zoxide init zsh. The documentation of these tools usually tell you to put something like eval "$(starship init zsh)" into your shell RC file. While this approach works fine, it does decrease startup speed of your shell because it needs to run the init command every time you open a new shell. Given that you open shells much more often than new versions of these tools are released and installed, you can cache the output of these commands to get a bit of speed back.'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-12T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-06T16:40:24+01:00"><meta property="article:tag" content="Chezmoi"><meta property="article:tag" content="Dotfiles"><meta property="article:tag" content="Shell"><meta property="article:tag" content="Performance"><meta name=twitter:card content="summary"><meta name=twitter:title content="chezmoi & shell init scripts"><meta name=twitter:description content='Many CLI applications offer initialization scripts to integrate into a shell, for example starship init zsh or zoxide init zsh. The documentation of these tools usually tell you to put something like eval "$(starship init zsh)" into your shell RC file. While this approach works fine, it does decrease startup speed of your shell because it needs to run the init command every time you open a new shell. Given that you open shells much more often than new versions of these tools are released and installed, you can cache the output of these commands to get a bit of speed back.'><meta itemprop=name content="chezmoi & shell init scripts"><meta itemprop=description content='Many CLI applications offer initialization scripts to integrate into a shell, for example starship init zsh or zoxide init zsh. The documentation of these tools usually tell you to put something like eval "$(starship init zsh)" into your shell RC file. While this approach works fine, it does decrease startup speed of your shell because it needs to run the init command every time you open a new shell. Given that you open shells much more often than new versions of these tools are released and installed, you can cache the output of these commands to get a bit of speed back.'><meta itemprop=datePublished content="2022-12-12T00:00:00+00:00"><meta itemprop=dateModified content="2023-01-06T16:40:24+01:00"><meta itemprop=wordCount content="259"><meta itemprop=keywords content="Chezmoi,Dotfiles,Shell,Performance"><link rel="shortcut icon" href=/favicon.ico><link rel=icon type=image/png href=/favicon-128.png sizes=128x128><link rel=apple-touch-icon type=image/png href=/favicon-128.png sizes=128x128><link rel=canonical href=https://seb.xn--ho-hia.de/posts/shell-init/><link rel=alternate type=application/atom+xml href=https://seb.xn--ho-hia.de/atom.xml title="Sebastian Hoß Atom"><link rel=alternate type=application/rss+xml href=https://seb.xn--ho-hia.de/index.xml title="Sebastian Hoß RSS"><link rel=sitemap type=application/xml href=https://seb.xn--ho-hia.de/sitemap.xml title="Sebastian Hoß Sitemap"><link rel=author type=text/plain href=https://seb.xn--ho-hia.de/humans.txt><link rel=alternate type=application/rdf+xml href=https://seb.xn--ho-hia.de/foaf.rdf title=FOAF><link rel=license href=https://creativecommons.org/publicdomain/zero/1.0/><link href=https://seb.xn--ho-hia.de/css/mobile.min.e14dc54fd7b9d2dea52a0580221a956079e9f0dbb1583eb2c3f19ab416911abcc496c1a81fe403d98380b4105b9a64ccddc0f3182b6174274a173e9dcd5c7c83.css integrity="sha512-4U3FT9e50t6lKgWAIhqVYHnp8NuxWD6yw/GatBaRGrzElsGoH+QD2YOAtBBbmmTM3cDzGCthdCdKFz6dzVx8gw==" media="screen and (max-width: 800px)" rel=stylesheet><link href=https://seb.xn--ho-hia.de/css/tablet.min.8aba29eb35692e2677e7c26e41408d9ed27ed94e71fe6634ad016f9e91a712f9e1c53317bdaf09aff9d1acc503c9dca0b3c3dc5d3a5f4c287d7ebd48eef1640a.css integrity="sha512-irop6zVpLiZ358JuQUCNntJ+2U5x/mY0rQFvnpGnEvnhxTMXva8Jr/nRrMUDydygs8PcXTpfTCh9fr1I7vFkCg==" media="screen and (min-width: 801px) and (max-width: 1199px)" rel=stylesheet><link href=https://seb.xn--ho-hia.de/css/desktop.min.5d7960c466db691c7fe9df667675aa312241bb90e879e462f75e2502350908820cf7477e12664f246157a8a37449baa5b2923035845e419b20b1cfdb177a0de8.css integrity="sha512-XXlgxGbbaRx/6d9mdnWqMSJBu5DoeeRi914lAjUJCIIM90d+EmZPJGFXqKN0SbqlspIwNYReQZsgsc/bF3oN6A==" media="screen and (min-width: 1200px)" rel=stylesheet><link href=https://seb.xn--ho-hia.de/css/darkmode.min.2a5ba1ebf79d23ac725522a486af2ffebf831a4a634fc1471a4b0007daa25afb4417f20dc4cf0e2c1eeb8eb704183160ff9aaf84e060180993fe1e010ac6907f.css integrity="sha512-Kluh6/edI6xyVSKkhq8v/r+DGkpjT8FHGksAB9qiWvtEF/INxM8OLB7rjrcEGDFg/5qvhOBgGAmT/h4BCsaQfw==" media="screen and (prefers-color-scheme: dark)" rel=stylesheet><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/","description":"articles about software engineering","license":"Creative Commons Zero v1.0 Universal","author":{"@type":"Person","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/"},"creator":{"@type":"Person","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/"},"accountablePerson":{"@type":"Person","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/"},"publisher":{"@type":"Person","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/"},"copyrightHolder":{"@type":"Person","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/"}}</script><script type=application/ld+json>{"@context":"https://schema.org/","@type":"Person","name":"Sebastian Hoß","email":"seb@xn--ho-hia.de","url":"https:\/\/seb.xn--ho-hia.de\/"}</script><title>Sebastian Hoß &ndash; chezmoi & shell init scripts</title></head><body id=site><header id=header><h1 id=projectname><a id=rootlink href=https://seb.xn--ho-hia.de/>Sebastian Hoß</a>
<a href=https://seb.xn--ho-hia.de/sitemap/ title="show me all pages" id=sitemaplink><img class=svgimg src=https://seb.xn--ho-hia.de/images/sitemap.svg alt=sitemap width=30 height=30></a></h1><span id=actions><a href=https://matrix.to/#/%40sebhoss%3amatrix.org id=matrix title="lets talk"><img class=svgimg src=https://seb.xn--ho-hia.de/images/matrix.svg alt=matrix width=32 height=32>
</a><a href=mailto:seb@xn--ho-hia.de id=email title="i want to write you an email"><img class=svgimg src=https://seb.xn--ho-hia.de/images/email.svg alt=email width=32 height=32>
</a><a rel=me href=https://mastodon.online/@sebhoss id=mastodon title="toot toot toot"><img class=svgimg src=https://seb.xn--ho-hia.de/images/mastodon.svg alt=mastodon width=32 height=32>
</a><a href=https://github.com/sebhoss id=github title="want some code?"><img class=svgimg src=https://seb.xn--ho-hia.de/images/github.svg alt=github width=32 height=32>
</a><a href=https://seb.xn--ho-hia.de/atom.xml id=newsfeed title="get notified about updates"><img class=svgimg src=https://seb.xn--ho-hia.de/images/rss.svg alt=newsfeed width=32 height=32></a></span></header><nav id=navigation><ul><h3 class="mobileonly menutitle">Links</h3><li class=mobileonly><a href=https://seb.xn--ho-hia.de/>Home</a></li><li class=mobileonly><a href=https://matrix.to/#/%40sebhoss%3amatrix.org>Let's talk on Matrix</a></li><li class=mobileonly><a href=mailto:seb@xn--ho-hia.de>Send me an email</a></li><li class=mobileonly><a href=https://mastodon.online/@sebhoss>Get in touch on Mastodon</a></li><li class=mobileonly><a href=https://github.com/sebhoss>See some code at GitHub</a></li><li class=mobileonly><a href=https://seb.xn--ho-hia.de/sitemap/>See all pages at the sitemap</a></li><li class=mobileonly><a href=https://seb.xn--ho-hia.de/atom.xml>Subscribe to the Atom feed</a></li><hr class="mobileonly menudivider"><h3 class="mobile-and-tablet menutitle">Navigation</h3><li><a href=https://seb.xn--ho-hia.de/posts/jspecify/>jspecify</a></li><li><a href=https://seb.xn--ho-hia.de/posts/chezmoi-age/>Using chezmoi with age</a></li><li><a href=https://seb.xn--ho-hia.de/posts/multiple-git-configs/>Multiple Git Configurations</a></li><li><a href=https://seb.xn--ho-hia.de/posts/passage-fuzzy-search/>passage fuzzy search</a></li><li><a href=https://seb.xn--ho-hia.de/posts/chezmoi-auto-update/>chezmoi auto-update</a></li><li><a href=https://seb.xn--ho-hia.de/posts/shell-init/ class=active>chezmoi & shell init scripts</a></li><li><a href=https://seb.xn--ho-hia.de/posts/awsenv/>awsenv</a></li><li><a href=https://seb.xn--ho-hia.de/posts/clojure-java-interoperability/>Clojure Java Interoperability</a></li><li><a href=https://seb.xn--ho-hia.de/posts/declarative-conditional-rendering-in-react/>Declarative conditional rendering in React</a></li><li><a href=https://seb.xn--ho-hia.de/posts/home-network-hostnames/>Proper hostnames in your local network</a></li><li><a href=https://seb.xn--ho-hia.de/posts/nvim-plugin-auto-updates/>Automatically update plugins for vim/nvim</a></li><li><a href=https://seb.xn--ho-hia.de/posts/tmux-tmuxp/>Manage tmux sessions with tmuxp</a></li><li><a href=https://seb.xn--ho-hia.de/posts/maven-cd-versioning/>Continuous Versioning with Maven</a></li><li><a href=https://seb.xn--ho-hia.de/posts/github-maven-packages/>GitHub Packages with Maven</a></li><li><a href=https://seb.xn--ho-hia.de/posts/maven-google-central/>Google Central</a></li></ul></nav><main id=content><h1 class=post-titel><a href=https://seb.xn--ho-hia.de/posts/shell-init/>chezmoi & shell init scripts
</a><a href=https://github.com/metio/seb/commits/main/content/shell-init title="View article history"><img src=https://seb.xn--ho-hia.de/images/history.svg alt="View article history" height=16 width=14 class="icon svgimg">
</a><a href=https://github.com/metio/seb/edit/main/content/shell-init title="Edit article"><img src=https://seb.xn--ho-hia.de/images/pencil.svg alt="Edit article" height=16 width=14 class="icon svgimg"></a></h1><div class=subtitle>Published: <time datetime=2022-12-12>December 12, 2022</time>
, Updated: <time datetime=2022-12-12>January 6, 2023</time></div><div class=subtitle>Talks about:
&lt;a class="post-tag post-tag-chezmoi" href="/tags/chezmoi">chezmoi&lt;/a>, &lt;a class="post-tag post-tag-dotfiles" href="/tags/dotfiles">dotfiles&lt;/a>, &lt;a class="post-tag post-tag-performance" href="/tags/performance">performance&lt;/a>, and &lt;a class="post-tag post-tag-shell" href="/tags/shell">shell&lt;/a></div><div id=post-content><p>Many CLI applications offer initialization scripts to integrate into a shell, for example <code>starship init zsh</code> or <code>zoxide init zsh</code>. The documentation of these tools usually tell you to put something like <code>eval "$(starship init zsh)"</code> into your shell RC file. While this approach works fine, it does decrease startup speed of your shell because it needs to run the <code>init</code> command every time you open a new shell. Given that you open shells much more often than new versions of these tools are released and installed, you can cache the output of these commands to get a bit of speed back.</p><p><a href=https://chezmoi.io/>chezmoi</a> provides a template function called <a href=https://www.chezmoi.io/reference/templates/functions/output/>output</a> which replaces itself with the output of the command you specified. You can use that function this to integrate various tools into your shell as the following example shows while using <code>zsh</code>:</p><ol><li>Create a directory that holds all init scripts for every tool you want to use.<div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl> $ mkdir --parents <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ZDOTDIR</span><span class=si>}</span><span class=s2>&#34;</span>/tools.d
</span></span></code></pre></div></li><li>Let your shell load all available scripts in that directory. This snippet should be part of your <code>.zshrc</code> file:<div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>for</span> init_script in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ZDOTDIR</span><span class=si>}</span><span class=s2>&#34;</span>/tools.d/*.sh<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=nb>source</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>init_script</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div></li><li>Create chezmoi <code>.tmpl</code> files for each tool and place them in the chezmoi source directory that matches the directory you created in step 1:<div class=highlight><pre tabindex=0 class=chroma><code class=language-go-text-template data-lang=go-text-template><span class=line><span class=cl><span class=cp>{{</span><span class=w> </span><span class=nx>output</span><span class=w> </span><span class=s>&#34;starship&#34;</span><span class=w> </span><span class=s>&#34;init&#34;</span><span class=w> </span><span class=s>&#34;zsh&#34;</span><span class=w> </span><span class=s>&#34;--print-full-init&#34;</span><span class=w> </span><span class=cp>}}</span><span class=x>
</span></span></span></code></pre></div></li><li>Call <code>chezmoi apply</code> to generate the init scripts.</li></ol><p>The only downside here is that you have to re-run <code>chezmoi apply</code> after updating one of the tools because they change their init scripts sometimes. That problem can be solved with <a href=../chezmoi-auto-update>chezmoi auto-updates</a>.</p></div><script type=application/ld+json src=jsonld.json></script></main><footer id=footer><p xmlns:dct=http://purl.org/dc/terms/ xmlns:vcard=http://www.w3.org/2001/vcard-rdf/3.0#><a rel=license href=https://creativecommons.org/publicdomain/zero/1.0/><img src=https://seb.xn--ho-hia.de/images/cc0.png style=border-style:none alt=CC0 width=88px height=31px></a><br>To the extent possible under law,
<a rel=dct:publisher href=https://seb.xn--ho-hia.de/><span property="dct:title">Sebastian Hoß</span>
</a>has waived all copyright and related or neighboring rights to
<span property="dct:title">seb.xn--ho-hia.de</span>.
This work is published from:
<span property="vcard:Country" datatype="dct:ISO3166" content="EN" about="https://seb.xn--ho-hia.de/">Germany</span></p></footer></body></html>