<!doctype html><html lang=en><head><meta charset=utf-8><meta name=author content="Sebastian Hoß"><meta name=subject content="Sebastian Hoß"><meta name=description content="articles about software engineering"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:url" content="https://seb.xn--ho-hia.de/posts/makefile-help/"><meta property="og:site_name" content="Sebastian Hoß"><meta property="og:title" content="Makefile Help"><meta property="og:description" content='Use the following Perl snippet to automatically generate help output for your Makefile:
GREEN := $(shell tput -Txterm setaf 2) WHITE := $(shell tput -Txterm setaf 7) YELLOW := $(shell tput -Txterm setaf 3) RESET := $(shell tput -Txterm sgr0) HELP_FUN = \ %help; \ while(<>) { push @{$$help{$$2 // &#39;targets&#39;}}, [$$1, $$3] if /^([a-zA-Z\-]+)\s*:.*\#\#(?:@([a-zA-Z\-]+))?\s(.*)$$/ }; \ print "usage: make [target]\n\n"; \ for (sort keys %help) { \ print "${WHITE}$$_:${RESET}\n"; \ for (@{$$help{$$_}}) { \ $$sep = " " x (32 - length $$_->[0]); \ print " ${YELLOW}$$_->[0]${RESET}$$sep${GREEN}$$_->[1]${RESET}\n"; \ }; \ print "\n"; } To use HELP_FUN, add the following help target to the same Makefile:'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-06-29T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-06T16:22:24+01:00"><meta property="article:tag" content="Make"><meta property="article:tag" content="Makefile"><meta property="article:tag" content="Help"><meta property="article:tag" content="Perl"><meta name=twitter:card content="summary"><meta name=twitter:title content="Makefile Help"><meta name=twitter:description content='Use the following Perl snippet to automatically generate help output for your Makefile:
GREEN := $(shell tput -Txterm setaf 2) WHITE := $(shell tput -Txterm setaf 7) YELLOW := $(shell tput -Txterm setaf 3) RESET := $(shell tput -Txterm sgr0) HELP_FUN = \ %help; \ while(<>) { push @{$$help{$$2 // &#39;targets&#39;}}, [$$1, $$3] if /^([a-zA-Z\-]+)\s*:.*\#\#(?:@([a-zA-Z\-]+))?\s(.*)$$/ }; \ print "usage: make [target]\n\n"; \ for (sort keys %help) { \ print "${WHITE}$$_:${RESET}\n"; \ for (@{$$help{$$_}}) { \ $$sep = " " x (32 - length $$_->[0]); \ print " ${YELLOW}$$_->[0]${RESET}$$sep${GREEN}$$_->[1]${RESET}\n"; \ }; \ print "\n"; } To use HELP_FUN, add the following help target to the same Makefile:'><meta itemprop=name content="Makefile Help"><meta itemprop=description content='Use the following Perl snippet to automatically generate help output for your Makefile:
GREEN := $(shell tput -Txterm setaf 2) WHITE := $(shell tput -Txterm setaf 7) YELLOW := $(shell tput -Txterm setaf 3) RESET := $(shell tput -Txterm sgr0) HELP_FUN = \ %help; \ while(<>) { push @{$$help{$$2 // &#39;targets&#39;}}, [$$1, $$3] if /^([a-zA-Z\-]+)\s*:.*\#\#(?:@([a-zA-Z\-]+))?\s(.*)$$/ }; \ print "usage: make [target]\n\n"; \ for (sort keys %help) { \ print "${WHITE}$$_:${RESET}\n"; \ for (@{$$help{$$_}}) { \ $$sep = " " x (32 - length $$_->[0]); \ print " ${YELLOW}$$_->[0]${RESET}$$sep${GREEN}$$_->[1]${RESET}\n"; \ }; \ print "\n"; } To use HELP_FUN, add the following help target to the same Makefile:'><meta itemprop=datePublished content="2020-06-29T00:00:00+00:00"><meta itemprop=dateModified content="2023-01-06T16:22:24+01:00"><meta itemprop=wordCount content="272"><meta itemprop=keywords content="Make,Makefile,Help,Perl"><link rel="shortcut icon" href=/favicon.ico><link rel=icon type=image/png href=/favicon-128.png sizes=128x128><link rel=apple-touch-icon type=image/png href=/favicon-128.png sizes=128x128><link rel=canonical href=https://seb.xn--ho-hia.de/posts/makefile-help/><link rel=alternate type=application/atom+xml href=https://seb.xn--ho-hia.de/atom.xml title="Sebastian Hoß Atom"><link rel=alternate type=application/rss+xml href=https://seb.xn--ho-hia.de/index.xml title="Sebastian Hoß RSS"><link rel=sitemap type=application/xml href=https://seb.xn--ho-hia.de/sitemap.xml title="Sebastian Hoß Sitemap"><link rel=author type=text/plain href=https://seb.xn--ho-hia.de/humans.txt><link rel=alternate type=application/rdf+xml href=https://seb.xn--ho-hia.de/foaf.rdf title=FOAF><link rel=license href=https://creativecommons.org/publicdomain/zero/1.0/><link href=https://seb.xn--ho-hia.de/css/mobile.min.e14dc54fd7b9d2dea52a0580221a956079e9f0dbb1583eb2c3f19ab416911abcc496c1a81fe403d98380b4105b9a64ccddc0f3182b6174274a173e9dcd5c7c83.css integrity="sha512-4U3FT9e50t6lKgWAIhqVYHnp8NuxWD6yw/GatBaRGrzElsGoH+QD2YOAtBBbmmTM3cDzGCthdCdKFz6dzVx8gw==" media="screen and (max-width: 800px)" rel=stylesheet><link href=https://seb.xn--ho-hia.de/css/tablet.min.8aba29eb35692e2677e7c26e41408d9ed27ed94e71fe6634ad016f9e91a712f9e1c53317bdaf09aff9d1acc503c9dca0b3c3dc5d3a5f4c287d7ebd48eef1640a.css integrity="sha512-irop6zVpLiZ358JuQUCNntJ+2U5x/mY0rQFvnpGnEvnhxTMXva8Jr/nRrMUDydygs8PcXTpfTCh9fr1I7vFkCg==" media="screen and (min-width: 801px) and (max-width: 1199px)" rel=stylesheet><link href=https://seb.xn--ho-hia.de/css/desktop.min.5d7960c466db691c7fe9df667675aa312241bb90e879e462f75e2502350908820cf7477e12664f246157a8a37449baa5b2923035845e419b20b1cfdb177a0de8.css integrity="sha512-XXlgxGbbaRx/6d9mdnWqMSJBu5DoeeRi914lAjUJCIIM90d+EmZPJGFXqKN0SbqlspIwNYReQZsgsc/bF3oN6A==" media="screen and (min-width: 1200px)" rel=stylesheet><link href=https://seb.xn--ho-hia.de/css/darkmode.min.2a5ba1ebf79d23ac725522a486af2ffebf831a4a634fc1471a4b0007daa25afb4417f20dc4cf0e2c1eeb8eb704183160ff9aaf84e060180993fe1e010ac6907f.css integrity="sha512-Kluh6/edI6xyVSKkhq8v/r+DGkpjT8FHGksAB9qiWvtEF/INxM8OLB7rjrcEGDFg/5qvhOBgGAmT/h4BCsaQfw==" media="screen and (prefers-color-scheme: dark)" rel=stylesheet><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/","description":"articles about software engineering","license":"Creative Commons Zero v1.0 Universal","author":{"@type":"Person","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/"},"creator":{"@type":"Person","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/"},"accountablePerson":{"@type":"Person","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/"},"publisher":{"@type":"Person","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/"},"copyrightHolder":{"@type":"Person","name":"Sebastian Hoß","url":"https:\/\/seb.xn--ho-hia.de\/"}}</script><script type=application/ld+json>{"@context":"https://schema.org/","@type":"Person","name":"Sebastian Hoß","email":"seb@xn--ho-hia.de","url":"https:\/\/seb.xn--ho-hia.de\/"}</script><title>Sebastian Hoß &ndash; Makefile Help</title></head><body id=site><header id=header><h1 id=projectname><a id=rootlink href=https://seb.xn--ho-hia.de/>Sebastian Hoß</a>
<a href=https://seb.xn--ho-hia.de/sitemap/ title="show me all pages" id=sitemaplink><img class=svgimg src=https://seb.xn--ho-hia.de/images/sitemap.svg alt=sitemap width=30 height=30></a></h1><span id=actions><a href=https://matrix.to/#/%40sebhoss%3amatrix.org id=matrix title="lets talk"><img class=svgimg src=https://seb.xn--ho-hia.de/images/matrix.svg alt=matrix width=32 height=32>
</a><a href=mailto:seb@xn--ho-hia.de id=email title="i want to write you an email"><img class=svgimg src=https://seb.xn--ho-hia.de/images/email.svg alt=email width=32 height=32>
</a><a rel=me href=https://mastodon.online/@sebhoss id=mastodon title="toot toot toot"><img class=svgimg src=https://seb.xn--ho-hia.de/images/mastodon.svg alt=mastodon width=32 height=32>
</a><a href=https://github.com/sebhoss id=github title="want some code?"><img class=svgimg src=https://seb.xn--ho-hia.de/images/github.svg alt=github width=32 height=32>
</a><a href=https://seb.xn--ho-hia.de/atom.xml id=newsfeed title="get notified about updates"><img class=svgimg src=https://seb.xn--ho-hia.de/images/rss.svg alt=newsfeed width=32 height=32></a></span></header><nav id=navigation><ul><h3 class="mobileonly menutitle">Links</h3><li class=mobileonly><a href=https://seb.xn--ho-hia.de/>Home</a></li><li class=mobileonly><a href=https://matrix.to/#/%40sebhoss%3amatrix.org>Let's talk on Matrix</a></li><li class=mobileonly><a href=mailto:seb@xn--ho-hia.de>Send me an email</a></li><li class=mobileonly><a href=https://mastodon.online/@sebhoss>Get in touch on Mastodon</a></li><li class=mobileonly><a href=https://github.com/sebhoss>See some code at GitHub</a></li><li class=mobileonly><a href=https://seb.xn--ho-hia.de/sitemap/>See all pages at the sitemap</a></li><li class=mobileonly><a href=https://seb.xn--ho-hia.de/atom.xml>Subscribe to the Atom feed</a></li><hr class="mobileonly menudivider"><h3 class="mobile-and-tablet menutitle">Navigation</h3><li><a href=https://seb.xn--ho-hia.de/posts/jspecify/>jspecify</a></li><li><a href=https://seb.xn--ho-hia.de/posts/chezmoi-age/>Using chezmoi with age</a></li><li><a href=https://seb.xn--ho-hia.de/posts/multiple-git-configs/>Multiple Git Configurations</a></li><li><a href=https://seb.xn--ho-hia.de/posts/passage-fuzzy-search/>passage fuzzy search</a></li><li><a href=https://seb.xn--ho-hia.de/posts/chezmoi-auto-update/>chezmoi auto-update</a></li><li><a href=https://seb.xn--ho-hia.de/posts/shell-init/>chezmoi & shell init scripts</a></li><li><a href=https://seb.xn--ho-hia.de/posts/awsenv/>awsenv</a></li><li><a href=https://seb.xn--ho-hia.de/posts/clojure-java-interoperability/>Clojure Java Interoperability</a></li><li><a href=https://seb.xn--ho-hia.de/posts/declarative-conditional-rendering-in-react/>Declarative conditional rendering in React</a></li><li><a href=https://seb.xn--ho-hia.de/posts/home-network-hostnames/>Proper hostnames in your local network</a></li><li><a href=https://seb.xn--ho-hia.de/posts/nvim-plugin-auto-updates/>Automatically update plugins for vim/nvim</a></li><li><a href=https://seb.xn--ho-hia.de/posts/tmux-tmuxp/>Manage tmux sessions with tmuxp</a></li><li><a href=https://seb.xn--ho-hia.de/posts/maven-cd-versioning/>Continuous Versioning with Maven</a></li><li><a href=https://seb.xn--ho-hia.de/posts/github-maven-packages/>GitHub Packages with Maven</a></li><li><a href=https://seb.xn--ho-hia.de/posts/maven-google-central/>Google Central</a></li></ul></nav><main id=content><h1 class=post-titel><a href=https://seb.xn--ho-hia.de/posts/makefile-help/>Makefile Help
</a><a href=https://github.com/metio/seb/commits/main/content/makefile-help title="View article history"><img src=https://seb.xn--ho-hia.de/images/history.svg alt="View article history" height=16 width=14 class="icon svgimg">
</a><a href=https://github.com/metio/seb/edit/main/content/makefile-help title="Edit article"><img src=https://seb.xn--ho-hia.de/images/pencil.svg alt="Edit article" height=16 width=14 class="icon svgimg"></a></h1><div class=subtitle>Published: <time datetime=2020-06-29>June 29, 2020</time>
, Updated: <time datetime=2020-06-29>January 6, 2023</time></div><div class=subtitle>Talks about:
&lt;a class="post-tag post-tag-help" href="/tags/help">help&lt;/a>, &lt;a class="post-tag post-tag-make" href="/tags/make">make&lt;/a>, &lt;a class="post-tag post-tag-makefile" href="/tags/makefile">Makefile&lt;/a>, and &lt;a class="post-tag post-tag-perl" href="/tags/perl">perl&lt;/a></div><div id=post-content><p>Use the following <a href=https://www.perl.org/>Perl</a> snippet to automatically generate help output for your <code>Makefile</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-makefile data-lang=makefile><span class=line><span class=cl><span class=nv>GREEN</span>  <span class=o>:=</span> <span class=k>$(</span>shell tput -Txterm setaf 2<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>WHITE</span>  <span class=o>:=</span> <span class=k>$(</span>shell tput -Txterm setaf 7<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>YELLOW</span> <span class=o>:=</span> <span class=k>$(</span>shell tput -Txterm setaf 3<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>RESET</span>  <span class=o>:=</span> <span class=k>$(</span>shell tput -Txterm sgr0<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>HELP_FUN</span> <span class=o>=</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    %help<span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=k>while</span><span class=o>(</span>&lt;&gt;<span class=o>)</span> <span class=o>{</span> push @<span class=o>{</span><span class=nv>$$</span>help<span class=o>{</span><span class=nv>$$</span><span class=m>2</span> // <span class=s1>&#39;targets&#39;</span><span class=o>}}</span>, <span class=o>[</span><span class=nv>$$</span>1, <span class=nv>$$</span>3<span class=o>]</span> <span class=k>if</span> /^<span class=o>([</span>a-zA-Z<span class=se>\-</span><span class=o>]</span>+<span class=o>)</span><span class=se>\s</span>*:.*<span class=se>\#\#</span><span class=o>(</span>?:@<span class=o>([</span>a-zA-Z<span class=se>\-</span><span class=o>]</span>+<span class=o>))</span>?<span class=se>\s</span><span class=o>(</span>.*<span class=o>)</span><span class=nv>$$</span>/ <span class=o>}</span><span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    print <span class=s2>&#34;usage: make [target]\n\n&#34;</span><span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=k>for</span> <span class=o>(</span>sort keys %help<span class=o>)</span> <span class=o>{</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    print <span class=s2>&#34;</span><span class=si>${</span><span class=nv>WHITE</span><span class=si>}</span><span class=nv>$$</span><span class=s2>_:</span><span class=si>${</span><span class=nv>RESET</span><span class=si>}</span><span class=s2>\n&#34;</span><span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=k>for</span> <span class=o>(</span>@<span class=o>{</span><span class=nv>$$</span>help<span class=o>{</span><span class=nv>$$</span>_<span class=o>}})</span> <span class=o>{</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=nv>$$sep</span> <span class=o>=</span> <span class=s2>&#34; &#34;</span> x <span class=o>(</span><span class=m>32</span> - length <span class=nv>$$</span>_-&gt;<span class=o>[</span>0<span class=o>])</span><span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    print <span class=s2>&#34;  </span><span class=si>${</span><span class=nv>YELLOW</span><span class=si>}</span><span class=nv>$$</span><span class=s2>_-&gt;[0]</span><span class=si>${</span><span class=nv>RESET</span><span class=si>}</span><span class=nv>$$</span><span class=s2>sep</span><span class=si>${</span><span class=nv>GREEN</span><span class=si>}</span><span class=nv>$$</span><span class=s2>_-&gt;[1]</span><span class=si>${</span><span class=nv>RESET</span><span class=si>}</span><span class=s2>\n&#34;</span><span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>}</span><span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    print <span class=s2>&#34;\n&#34;</span><span class=p>;</span> <span class=o>}</span>
</span></span></code></pre></div><p>To use <code>HELP_FUN</code>, add the following <code>help</code> target to the same <code>Makefile</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-makefile data-lang=makefile><span class=line><span class=cl><span class=nv>.DEFAULT_GOAL</span> <span class=o>:=</span> <span class=nb>help</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>help</span>
</span></span><span class=line><span class=cl><span class=nf>help</span><span class=o>:</span> <span class=c>##@other Show this help
</span></span></span><span class=line><span class=cl><span class=c></span>	@perl -e <span class=s1>&#39;$(HELP_FUN)&#39;</span> <span class=k>$(</span>MAKEFILE_LIST<span class=k>)</span>
</span></span></code></pre></div><p>Each target in the <code>Makefile</code> is marked as <a href=https://www.gnu.org/software/make/manual/html_node/Phony-Targets.html>phony</a> to signal that those targets are not actually files that are generated as part of your build process. The optional description of a target can be placed after the <code>##@</code> prefix. The first word represents the group of a target and everything that follows is the description of a target. All targets should be formatted just like the <code>help</code> target:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-makefile data-lang=makefile><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>compile</span>
</span></span><span class=line><span class=cl><span class=nf>compile</span><span class=o>:</span> <span class=c>##@hacking Compile your code
</span></span></span><span class=line><span class=cl><span class=c></span>	&lt;compile some code&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>test</span>
</span></span><span class=line><span class=cl><span class=nf>test</span><span class=o>:</span> <span class=c>##@hacking Test your code
</span></span></span><span class=line><span class=cl><span class=c></span>	&lt;<span class=nb>test</span> some code&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>sign</span>-<span class=n>cla</span>
</span></span><span class=line><span class=cl><span class=nf>sign-cla</span><span class=o>:</span> <span class=c>##@contrib Sign the contributor license agreement
</span></span></span><span class=line><span class=cl><span class=c></span>	&lt;sign some file&gt;
</span></span></code></pre></div><p>Once in place, you can either use <code>make</code> without any argument to call the <code>help</code> target or use <code>make help</code> to see the generated output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ make
</span></span><span class=line><span class=cl>usage: make <span class=o>[</span>target<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>contrib:
</span></span><span class=line><span class=cl>  sign-cla            Sign the contributor license agreement
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>hacking:
</span></span><span class=line><span class=cl>  compile             Compile your code
</span></span><span class=line><span class=cl>  <span class=nb>test</span>                Test your code
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>other:
</span></span><span class=line><span class=cl>  <span class=nb>help</span>                Show this <span class=nb>help</span>
</span></span></code></pre></div></div><script type=application/ld+json src=jsonld.json></script></main><footer id=footer><p xmlns:dct=http://purl.org/dc/terms/ xmlns:vcard=http://www.w3.org/2001/vcard-rdf/3.0#><a rel=license href=https://creativecommons.org/publicdomain/zero/1.0/><img src=https://seb.xn--ho-hia.de/images/cc0.png style=border-style:none alt=CC0 width=88px height=31px></a><br>To the extent possible under law,
<a rel=dct:publisher href=https://seb.xn--ho-hia.de/><span property="dct:title">Sebastian Hoß</span>
</a>has waived all copyright and related or neighboring rights to
<span property="dct:title">seb.xn--ho-hia.de</span>.
This work is published from:
<span property="vcard:Country" datatype="dct:ISO3166" content="EN" about="https://seb.xn--ho-hia.de/">Germany</span></p></footer></body></html>