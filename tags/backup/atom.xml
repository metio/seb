<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://gohugo.io/" version="0.128.0">Hugo</generator><title type="html">Backup on Sebastian Ho√ü</title><link href="https://seb.xn--ho-hia.de/tags/backup/" rel="alternate" type="text/html" title="html"/><link href="https://seb.xn--ho-hia.de/tags/backup/index.xml" rel="alternate" type="application/rss+xml" title="rss"/><link href="https://seb.xn--ho-hia.de/tags/backup/atom.xml" rel="self" type="application/atom+xml" title="atom"/><updated>2024-07-01T02:33:53+00:00</updated><id>https://seb.xn--ho-hia.de/tags/backup/</id><entry><title type="html">Backups with emacs</title><link href="https://seb.xn--ho-hia.de/posts/emacs-backups/?utm_source=atom_feed" rel="alternate" type="text/html"/><link href="https://seb.xn--ho-hia.de/posts/emacs-systemd/?utm_source=atom_feed" rel="related" type="text/html" title="emacs and systemd"/><id>https://seb.xn--ho-hia.de/posts/emacs-backups/</id><published>2021-10-25T00:00:00+00:00</published><updated>2023-01-06T15:27:21+01:00</updated><content type="html"><![CDATA[<p><a href="https://www.gnu.org/software/emacs/">emacs</a> will create backups of your files by default. Those backups are located right next to the original file and are called <code>&lt;file&gt;~</code>. Unfortunately, emacs will not clean those up by default, which annoys me from time to time. Therefore, I&rsquo;m now using the following configuration to keep those backups in a different folder:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-el" data-lang="el"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">setq</span> <span class="nv">version-control</span> <span class="no">t</span>     <span class="c1">;; Use version numbers for backups.</span>
</span></span><span class="line"><span class="cl">      <span class="nv">kept-new-versions</span> <span class="mi">10</span>  <span class="c1">;; Number of newest versions to keep.</span>
</span></span><span class="line"><span class="cl">      <span class="nv">kept-old-versions</span> <span class="mi">0</span>   <span class="c1">;; Number of oldest versions to keep.</span>
</span></span><span class="line"><span class="cl">      <span class="nv">delete-old-versions</span> <span class="no">t</span> <span class="c1">;; Don&#39;t ask to delete excess backup versions.</span>
</span></span><span class="line"><span class="cl">      <span class="nv">backup-by-copying</span> <span class="no">t</span><span class="p">)</span>  <span class="c1">;; Copy all files, don&#39;t rename them.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">setq</span> <span class="nv">vc-make-backup-files</span> <span class="no">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; Default and per-save backups go here:</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">setq</span> <span class="nv">backup-directory-alist</span> <span class="o">&#39;</span><span class="p">((</span><span class="s">&#34;&#34;</span> <span class="o">.</span> <span class="s">&#34;~/.emacs.d/backup/per-save&#34;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">defun</span> <span class="nv">force-backup-of-buffer</span> <span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="c1">;; Make a special &#34;per session&#34; backup at the first save of each</span>
</span></span><span class="line"><span class="cl">  <span class="c1">;; emacs session.</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">not</span> <span class="nv">buffer-backed-up</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">;; Override the default parameters for per-session backups.</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">let</span> <span class="p">((</span><span class="nv">backup-directory-alist</span> <span class="o">&#39;</span><span class="p">((</span><span class="s">&#34;&#34;</span> <span class="o">.</span> <span class="s">&#34;~/.emacs.d/backup/per-session&#34;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nv">kept-new-versions</span> <span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nv">backup-buffer</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">  <span class="c1">;; Make a &#34;per save&#34; backup on each save.  The first save results in</span>
</span></span><span class="line"><span class="cl">  <span class="c1">;; both a per-session and a per-save backup, to keep the numbering</span>
</span></span><span class="line"><span class="cl">  <span class="c1">;; of per-save backups consistent.</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">let</span> <span class="p">((</span><span class="nv">buffer-backed-up</span> <span class="no">nil</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nv">backup-buffer</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nv">add-hook</span> <span class="ss">&#39;before-save-hook</span>  <span class="ss">&#39;force-backup-of-buffer</span><span class="p">)</span>
</span></span></code></pre></div><p>Thanks to that configuration, backups per-save will be created in <code>~/.emacs.d/backup/per-save</code> and backups per-session in <code>~/.emacs.d/backup/per-session</code>.</p>
]]></content><category scheme="https://seb.xn--ho-hia.de/categories/snippet" term="snippet" label="snippet"/><category scheme="https://seb.xn--ho-hia.de/tags/emacs" term="emacs" label="emacs"/><category scheme="https://seb.xn--ho-hia.de/tags/backup" term="backup" label="backup"/></entry></feed>